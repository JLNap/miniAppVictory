# Как настроить Supabase для комнат и чата

Пошаговая инструкция. Займёт 5–10 минут.

---

## Шаг 1. Регистрация и проект

1. Открой **https://supabase.com** в браузере.
2. Нажми **Start your project** (или **Sign in**).
3. Войди через GitHub (удобнее) или по email.
4. После входа нажми **New Project**.
5. Заполни:
   - **Name** — например `quiz-app` (любое имя).
   - **Database Password** — придумай и **сохрани** пароль (он нужен только для доступа к БД с панели, в коде приложения не используется).
   - **Region** — выбери ближайший (например Frankfurt).
6. Нажми **Create new project** и подожди 1–2 минуты, пока проект создаётся.

---

## Шаг 2. Создать таблицы (SQL)

1. В левом меню Supabase выбери **SQL Editor** (иконка с символом `</>`).
2. Нажми **New query**.
3. Открой у себя на компьютере файл **`supabase/schema.sql`** из этого проекта и **скопируй весь его текст** (Ctrl+A, Ctrl+C).
4. Вставь скопированный текст в окно запроса в Supabase (в большое поле).
5. Нажми **Run** (или Ctrl+Enter).
6. Внизу должно появиться зелёное сообщение вроде **Success** — значит таблицы созданы.

---

## Шаг 3. Включить Realtime

1. В левом меню выбери **Database** → **Replication** (или **Realtime** в старых версиях).
2. Увидишь список таблиц. Включи репликацию (переключатель **ON**) для:
   - **rooms**
   - **room_players**
   - **room_messages**
   - **room_answers**

Если какой-то таблицы нет в списке — обнови страницу после Шага 2.

---

## Шаг 4. Скопировать URL и ключ

1. В левом меню нажми **Project Settings** (иконка шестерёнки внизу).
2. Выбери раздел **API**.
3. Найди два значения:
   - **Project URL** — ссылка вида `https://xxxxxxxxxxxx.supabase.co`
   - **Project API keys** → **anon public** — длинная строка символов (начинается с `eyJ...`)

Скопируй оба и сохрани в блокнот: они понадобятся в следующем шаге.

---

## Шаг 5. Вставить данные в проект

1. Открой в проекте файл **`js/supabase-config.js`**.
2. Замени пустые строки на свои значения:

```js
const SUPABASE_URL = 'https://ТВОЙ_ПРОЕКТ.supabase.co';   // вставь свой Project URL
const SUPABASE_ANON_KEY = 'eyJhbGciOi...';                // вставь свой anon key
```

3. Сохрани файл.

---

## Шаг 6. Залить на GitHub и Vercel

1. В терминале из папки проекта выполни:

```bash
cd /Users/jlnap/myProjects/telegram-quiz-miniapp
git add js/supabase-config.js
git commit -m "Add Supabase config"
git push
```

2. Vercel сам подхватит изменения и сделает новый деплой (подожди 1–2 минуты).
3. Открой Mini App в Telegram — вкладка «С друзьями» должна работать: можно создать комнату и войти по коду.

---

## Если что-то пошло не так

- **«Failed to fetch» / ошибка при создании комнаты** — проверь, что в `supabase-config.js` вставлены именно **Project URL** и **anon public** (не secret key).
- **Чат не обновляется / игроки не видят друг друга** — убедись, что в **Database → Replication** включены все 4 таблицы.
- **Таблицы не создаются** — в SQL Editor скопируй текст из `supabase/schema.sql` целиком и нажми Run ещё раз.

Готово. После этого комнаты и чат работают в твоей викторине.
